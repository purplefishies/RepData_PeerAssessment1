---
title: "Reproducible Research Project"
author: "Jimi Damon"
date: "06/03/2015"
output: html_document
framework   : io2012        # {io2012, html5slides, shower, dzslides, ...}
highlighter : highlight.js  # {highlight.js, prettify, highlight}
hitheme     : tomorrow      # 
url:
  lib: ../../librariesNew
  assets: ../../assets
widgets     : [mathjax]            # {mathjax, quiz, bootstrap}
mode        : selfcontained # {standalone, draft}
---

Placeholder Introduction stuff

## Loading and preprocessing the data

```{r,echo=FALSE}
library(knitr)
library(ggplot2)
library(dplyr)
library(lubridate)
```

# Loading and preprocessing the data.

```{r,echo=TRUE}
data <- tbl_df(read.csv("./activity.csv",sep = ","))
```

Replaceing  it is important to replace the elements that are NA with 
at leat a best guess of each value.
ste


## What is mean total number of steps taken per day?

```{r,echo=TRUE}
perday <-  data %>% group_by( date ) %>% summarise( total_steps =sum(steps,na.rm=T ))
hist(perday$total_steps)
```
##Calculate and report the mean and median of the total number of steps taken per day
```{r,echo=TRUE,results='asis'}
perday_stats <- data %>% transmute( steps=ifelse(is.na(steps),0,steps), date=date,interval=interval) %>%
   group_by( date ) %>% summarise( mean_steps = mean(steps ), median_steps = median(steps)) 
knitr::kable(perday_stats)
```

## What is the average daily activity pattern?

### The following chart is the average number of steps taken per 5 minute period
```{r,echo=TRUE}
per_interval <- data %>% transmute( steps=ifelse(is.na(steps),0,steps), date=date,interval=interval) %>% 
   group_by( interval ) %>% summarise( ave_steps = mean(steps ))
plot(per_interval$interval,per_interval$ave_steps,type="l")
```

### The following represents the maximum 
```{r,echo=TRUE}
index <- which(per_interval$ave_steps == max( per_interval$ave_steps ))
per_interval[index,]$interval
```

## Imputing missing values


```{r,echo=TRUE}
replacements <- data %>%
  filter( !is.na(steps)) %>% 
  group_by(interval) %>% 
  summarize( ave_steps = floor(mean(steps)))
```


```{r,echo=TRUE}
altered <- mutate(data, date=date,steps = ifelse(  is.na(steps) , replacements[which( interval == replacements$interval )]$ave_steps, steps))
```

```{r,echo=TRUE}
perday <-  altered %>% group_by( date ) %>% summarise( total_steps =sum(steps ))
hist(perday$total_steps)
```

```{r,echo=TRUE}
per_interval <- altered %>% group_by( interval ) %>% summarise( ave_steps = mean(steps ))
plot( ts(per_interval$interval), per_interval$ave_steps , type="l")
```

##Calculate and report the mean and median of the total number of steps taken per day
```{r,echo=TRUE,results='asis'}
perday_stats <- altered %>% group_by( date ) %>% summarise( mean_steps = mean(steps ), median_steps = median(steps))
knitr::kable(perday_stats)
```



## Are there differences in activity patterns between weekdays and weekends?

